// Generated by CoffeeScript 1.7.1
(function() {
  $(function() {
    var peer, play, socket;
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
    play = $("#play");
    peer = new Peer({
      key: "ca99fd4a-8e43-11e4-b490-ff1e952f2799"
    });
    socket = io.connect();
    return peer.on("open", function(id) {
      console.log(id);
      return play.on("click", function() {
        console.log("Clicked");
        socket.emit("call", id);
        return peer.on("call", function(call) {
          call.answer();
          return call.on("stream", function(remote_stream) {
            var audio;
            console.log("Called");
            audio = document.querySelector("#audio");
            audio.src = window.URL.createObjectURL(remote_stream);
            return audio.play();
          });
        });
      });
    });
  });

}).call(this);
