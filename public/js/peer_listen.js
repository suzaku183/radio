// Generated by CoffeeScript 1.8.0
(function() {
  $(function() {
    var peer, play, socket;
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
    play = $("#play");
    peer = new Peer({
      key: 'ca99fd4a-8e43-11e4-b490-ff1e952f2799'
    });
    socket = io.connect();
    console.log(util.supports.data);
    if (util.supports.data) {
      $("#use").text("You can use");
    } else {
      $("#use").text("You can not use");
    }
    return peer.on("open", function(id) {
      console.log("お客様のIDは" + id + "です");
      play.on("click", function() {
        return socket.emit("call", id);
      });
      return peer.on("call", function(call) {
        call.answer();
        return call.on("stream", function(remote_stream) {
          var audio;
          console.log("Called");
          audio = document.querySelector("#audio");
          audio.src = window.URL.createObjectURL(remote_stream);
          return audio.play();
        });
      });
    });
  });

}).call(this);
