// Generated by CoffeeScript 1.8.0
(function() {
  $(function() {
    var broad_cast, socket, started;
    socket = io.connect();
    broad_cast = $("#broad_cast");
    started = false;
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
    socket.on("check_deliver_radio", function(data) {
      return socket.emit("answer_radio_propery", started);
    });
    return broad_cast.on("click", function() {
      console.log("Clicked broad cast");
      return navigator.getUserMedia({
        audio: true
      }, function(stream) {
        var peer;
        started = true;
        socket.emit("start_radio", true);
        peer = new Peer({
          key: 'ca99fd4a-8e43-11e4-b490-ff1e952f2799'
        });
        console.log("Waiting lisnener");
        return peer.on("open", function(id) {
          console.log("配信者のIDは" + id + "です");
          return socket.on("recive_listener", function(key) {
            var call;
            console.log(key);
            return call = peer.call(key, stream);
          });
        });
      }, function(err) {
        return console.log(err);
      });
    });
  });

}).call(this);
